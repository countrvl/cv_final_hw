# üõ† –û—Ç—á—ë—Ç –ø–æ –∑–∞–¥–∞–Ω–∏—é: –î–µ—Ç–µ–∫—Ü–∏—è, —Ç—Ä–µ–∫–∏–Ω–≥ –∏ –ø–æ–¥—Å—á—ë—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º–µ, –ø—Ä–∏–Ω—è—Ç–æ–π –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî —á—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –º–æ–¥–µ–ª–µ–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫, –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è.

```
cv_final_hw/
‚îú‚îÄ‚îÄ data/                  # –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ input_video/       # –∏—Å—Ö–æ–¥–Ω—ã–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ models/            # –≤–µ—Å–∞ YOLOv8
‚îÇ   ‚îî‚îÄ‚îÄ outputs/           # –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–¥—Ä—ã, –≤–∏–¥–µ–æ –∏ –ø—Ä.
‚îú‚îÄ‚îÄ notebooks/             # jupyter-–Ω–æ—É—Ç–±—É–∫–∏ —Å –∫–æ–¥–æ–º –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ hw_final.ipynb     # –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–æ—É—Ç–±—É–∫ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ .gitignore             # –∏—Å–∫–ª—é—á–∞–µ—Ç –≤–µ—Å–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –≤–∏–¥–µ–æ –∏–∑ Git
‚îî‚îÄ‚îÄ README.md              # –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–¶–µ–ª—å ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–±–æ—á—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è:

* –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –Ω–∞ –≤–∏–¥–µ–æ —Å —É–ª–∏—á–Ω–æ–π –∫–∞–º–µ—Ä—ã;
* –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏—Ö –¥–≤–∏–∂–µ–Ω–∏–µ –æ—Ç –∫–∞–¥—Ä–∞ –∫ –∫–∞–¥—Ä—É (—Ç—Ä–µ–∫–∏–Ω–≥);
* —Å—á–∏—Ç–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –º–∞—à–∏–Ω –ø–µ—Ä–µ—Å–µ–∫–ª–æ –ª–∏–Ω–∏—é (–ø–µ—à–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥);
* –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è –≤–∏–∑—É–∞–ª—å–Ω–æ (–≤–∏–¥–µ–æ —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –±–æ–∫—Å–∞–º–∏, ID, –ø–æ–¥—Å—á—ë—Ç–æ–º);
* —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ `.mp4` –≤–∏–¥–µ–æ.

–†–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É—Å—Ç–æ–π—á–∏–≤–æ, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ –∏ –ø—Ä–∏–≥–æ–¥–Ω–æ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –≤–∏–¥–µ–æ/—Å—Ü–µ–Ω–∞—Ö.

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* **YOLOv8s** –æ—Ç Ultralytics ‚Äî —Ç–æ—á–Ω–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤
* **BoT-SORT** ‚Äî —Ç—Ä–µ–∫–µ—Ä, –Ω–∞–∑–Ω–∞—á–∞—é—â–∏–π ID –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏
* **OpenCV** ‚Äî –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤–∏–¥–µ–æ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –ø–æ–≤–µ—Ä—Ö –∫–∞–¥—Ä–æ–≤
* **Python 3.12** ‚Äî –≤—Å—è –ª–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ Jupyter-–Ω–æ—É—Ç–±—É–∫–µ
* **CUDA —Å GPU (RTX 4070)** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ YOLOv8

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –∑–∞–¥–∞–Ω–∏—è

### –≠—Ç–∞–ø 0 ‚Äî –í—ã–±–æ—Ä –≤–∏–¥–µ–æ

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ —Å –≥–æ—Ä–æ–¥—Å–∫–æ–π –∫–∞–º–µ—Ä—ã, –≥–¥–µ –≤–∏–¥–Ω–æ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–æ–∫ —Å –ø–µ—à–µ—Ö–æ–¥–Ω—ã–º –ø–µ—Ä–µ—Ö–æ–¥–æ–º. –ú–∞—à–∏–Ω—ã —Ä–∞–∑–ª–∏—á–∏–º—ã –¥–∞–∂–µ –≤–¥–∞–ª–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é –ø–æ–≥–æ–¥—É. –£–≥–æ–ª —Å—ä—ë–º–∫–∏ —Å –≤—ã—Å–æ—Ç—ã –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–Ω–∏–π –∏ –æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞.

### –≠—Ç–∞–ø 1 ‚Äî –î–µ—Ç–µ–∫—Ü–∏—è –∏ —Ç—Ä–µ–∫–∏–Ω–≥

–ó–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å YOLOv8s –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤:

* `classes=[2, 3, 5, 7]` ‚Äî –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, –º–æ—Ç–æ—Ü–∏–∫–ª—ã, –∞–≤—Ç–æ–±—É—Å—ã, –≥—Ä—É–∑–æ–≤–∏–∫–∏

–î–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ –≤—ã–±—Ä–∞–Ω BoT-SORT ‚Äî —É—Å—Ç–æ–π—á–∏–≤—ã–π –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ Ultralytics. –ë–ª–∞–≥–æ–¥–∞—Ä—è –µ–º—É –∫–∞–∂–¥—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã–π –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏.

### –≠—Ç–∞–ø 2 ‚Äî –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–∏–Ω–∏–∏ –ø–æ–¥—Å—á—ë—Ç–∞

–õ–∏–Ω–∏—è –ø–æ–¥—Å—á—ë—Ç–∞ –≤—Ä—É—á–Ω—É—é –≤—ã–±—Ä–∞–Ω–∞ –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ –ø–µ—à–µ—Ö–æ–¥–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞:

```python
LINE = ((946, 562), (1077, 547))
```

–í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –≤—Ä—É—á–Ω—É—é.

### –≠—Ç–∞–ø 3 ‚Äî –õ–æ–≥–∏–∫–∞ –ø–æ–¥—Å—á—ë—Ç–∞

–ü–æ–¥—Å—á—ë—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ü–µ–Ω—Ç—Ä–∞ –∫–∞–∂–¥–æ–≥–æ bbox:

* —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ª–∏–Ω–∏–∏ **–≤ –æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏** (—Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö);
* –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä—ã —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–æ `tracked_once`;
* —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ `cy` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ID.

### –≠—Ç–∞–ø 4 ‚Äî –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–í –∫–∞–¥—Ä–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:

* bounding box –∏ ID;
* —Ü–µ–Ω—Ç—Ä –æ–±—ä–µ–∫—Ç–∞ (–º–∞–ª–µ–Ω—å–∫–∞—è —Ç–æ—á–∫–∞);
* –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–∞ (`car`, `truck`, –∏ —Ç.–ø.);
* –ª–∏–Ω–∏—è –ø–æ–¥—Å—á—ë—Ç–∞;
* —Å—á—ë—Ç—á–∏–∫ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—à–∏–Ω;
* —Ü–≤–µ—Ç: —Å–∏–Ω–∏–π ‚Äî –µ—â—ë –Ω–µ –ø–µ—Ä–µ—Å—ë–∫, –∫—Ä–∞—Å–Ω—ã–π ‚Äî —É–∂–µ —É—á—Ç—ë–Ω.

### –≠—Ç–∞–ø 5 ‚Äî –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –ø–æ–ª–Ω–æ–º –≤–∏–¥–µ–æ (\~2 –º–∏–Ω—É—Ç—ã).

* –ü–æ–¥—Å—á—ë—Ç —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ;
* –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω –≤—Ä—É—á–Ω—É—é –ø–æ –∫–∞–¥—Ä–∞–º;
* –û—à–∏–±–∫–∏ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ ID –∏–ª–∏ —Å–±–æ—è–º–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `None`.

---

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

üî∏ **ROI (Region of Interest)** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–æ–Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –≤–æ–∫—Ä—É–≥ –ø–µ—à–µ—Ö–æ–¥–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞, —á—Ç–æ–±—ã:

* –∏—Å–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –º–∞—à–∏–Ω –≤–¥–∞–ª–∏;
* —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π;
* —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–∞–¥—Ä–∞.

üî∏ **–ó–∞–º–µ–Ω–∞ YOLOv8n ‚Üí YOLOv8s** ‚Äî –ø–æ–≤—ã—à–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.

üî∏ **–ü–æ–¥–ø–∏—Å–∏ –∫–ª–∞—Å—Å–æ–≤** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥–ø–∏—Å–∏ `car`, `truck` –∏ —Ç.–¥. –ø–æ–≤–µ—Ä—Ö bbox.

üî∏ **–≠–∫—Å–ø–æ—Ä—Ç –≤ .mp4** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –≤–∏–¥–µ–æ `output_annotated.mp4` —Å –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–Ω—ã–º–∏ ID, –∫–ª–∞—Å—Å–∞–º–∏ –∏ —Å—á—ë—Ç—á–∏–∫–æ–º.

---

## ‚ö†Ô∏è –¢—Ä—É–¥–Ω–æ—Å—Ç–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. YOLO –ø–ª–æ—Ö–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–ª –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –≤–¥–∞–ª–µ–∫–µ

**–ü—Ä–∏—á–∏–Ω–∞:** —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å `yolov8n.pt`
**–†–µ—à–µ–Ω–∏–µ:** –∑–∞–º–µ–Ω–∞ –Ω–∞ `yolov8s.pt`, —á—Ç–æ –¥–∞–ª–æ –ø—Ä–∏—Ä–æ—Å—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ 30‚Äì50%

### 2. ID –æ–±—ä–µ–∫—Ç–æ–≤ —Å–±—Ä–∞—Å—ã–≤–∞–ª—Å—è, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** BoT-SORT —Ç–µ—Ä—è–µ—Ç ID –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏
**–†–µ—à–µ–Ω–∏–µ:** –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º `last_cy` + `tracked_once` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–≤—Ç–æ—Ä–æ–≤

### 3. –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –æ–±—ä–µ–∫—Ç—ã –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Å—Ü–µ–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:** –¥–æ–±–∞–≤–ª–µ–Ω ROI ‚Äî –∫—Ä–æ–ø –∫–∞–¥—Ä–∞ –≤–æ–∫—Ä—É–≥ –ª–∏–Ω–∏–∏ –ø–æ–¥—Å—á—ë—Ç–∞

### 4. YOLO –∏–Ω–æ–≥–¥–∞ –Ω–µ –≤—ã–¥–∞—ë—Ç ID –≤ –ø–µ—Ä–≤—ã–µ –∫–∞–¥—Ä—ã

**–†–µ—à–µ–Ω–∏–µ:** –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `if box.id is None` –∏ `if results.boxes.id is not None`

---

## üì¶ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

üìå –í—Å–µ –ø—É–Ω–∫—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:

* YOLO + —Ç—Ä–µ–∫–∏–Ω–≥
* –ü–æ–¥—Å—á—ë—Ç –º–∞—à–∏–Ω —á–µ—Ä–µ–∑ –ª–∏–Ω–∏—é
* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, —Å—á—ë—Ç—á–∏–∫ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ `.mp4`
* –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –º–æ–¥–µ–ª–∏ –∏ —Ç—Ä–µ–∫–µ—Ä–∞

